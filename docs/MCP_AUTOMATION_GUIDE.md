# 🔧 MCP를 활용한 완전 자동화 가이드

Cursor의 MCP(Model Context Protocol) 기능을 활용하여 개발 워크플로우를 완전히 자동화하는 방법입니다.

## 🎯 목표

**현재 워크플로우:**
1. Cursor에서 개발
2. Git push
3. Vercel 배포 확인 (수동)
4. 에러 로그 복사 (수동)
5. Cursor에 입력 (수동)
6. 수정 및 반복

**자동화된 워크플로우:**
1. Cursor에서 개발
2. "배포하고 에러 확인해줘" 명령어
3. 자동으로 Git push → 배포 모니터링 → 에러 감지 → 수정 → 재배포

## 🚀 설정 방법

### Step 1: Vercel API 토큰 생성

1. Vercel Dashboard 접속: https://vercel.com/account/tokens
2. **Create Token** 클릭
3. 토큰 이름 입력 (예: "Cursor MCP")
4. 토큰 복사 (한 번만 표시됨!)

### Step 2: Cursor MCP 설정

1. Cursor 설정 열기 (`Cmd/Ctrl + ,`)
2. **Features** → **MCP** 섹션 찾기
3. Vercel MCP 서버 추가:
   ```json
   {
     "mcpServers": {
       "vercel": {
         "command": "npx",
         "args": ["-y", "@modelcontextprotocol/server-vercel"],
         "env": {
           "VERCEL_TOKEN": "your-vercel-token-here"
         }
       }
     }
   }
   ```

### Step 3: 테스트

Cursor에서 다음 명령어로 테스트:

```
"Vercel 프로젝트 목록을 보여줘"
```

정상 작동하면 프로젝트 목록이 표시됩니다.

## 💬 사용 가능한 자동화 명령어

### 1. 배포 및 모니터링

```
"최근 코드 변경사항을 커밋하고 푸시한 다음, 
Vercel에 배포하고 배포 상태를 모니터링해줘. 
에러가 있으면 로그를 보여줘"
```

### 2. 에러 자동 수정

```
"Vercel 배포 중 에러가 발생했어. 
최근 배포의 빌드 로그를 확인하고 에러를 수정해줘"
```

### 3. 완전 자동화

```
"이 변경사항을 배포하고, 
에러가 있으면 자동으로 수정하고, 
성공할 때까지 반복해줘"
```

## 🔄 자동화 워크플로우 예시

### 시나리오 1: 일반 배포

**사용자 입력:**
```
"코드 수정했어. 배포하고 상태 확인해줘"
```

**자동 실행:**
1. ✅ Git 커밋 및 푸시
2. ✅ Vercel 배포 시작
3. ✅ 배포 상태 모니터링
4. ✅ 성공/실패 보고

### 시나리오 2: 에러 발생 시

**사용자 입력:**
```
"배포 에러가 발생했어. 확인하고 수정해줘"
```

**자동 실행:**
1. ✅ 최근 배포 조회
2. ✅ 빌드 로그 가져오기
3. ✅ 에러 분석
4. ✅ 코드 수정
5. ✅ 재배포

### 시나리오 3: 완전 자동화

**사용자 입력:**
```
"이 코드를 배포하고, 에러가 있으면 자동으로 수정해줘"
```

**자동 실행:**
1. ✅ Git 커밋 및 푸시
2. ✅ 배포 시작
3. ✅ 상태 모니터링
4. ❌ 에러 감지
5. ✅ 에러 분석 및 수정
6. ✅ 재배포
7. ✅ 성공할 때까지 반복

## 📝 스크립트 활용

### 자동 커밋 및 푸시

```bash
npm run deploy "수정 내용 설명"
```

이 명령어는:
- 변경사항 자동 감지
- Git 커밋 및 푸시
- 배포 모니터링 안내

### 배포 모니터링

```bash
npm run monitor [deployment-id]
```

## 🎨 Cursor Composer 활용

Cursor의 Composer 기능을 사용하면 더욱 강력합니다:

### 예시 1: 단순 배포

```
Composer에서:
"이 변경사항을 배포해줘"
```

### 예시 2: 에러 수정 포함

```
Composer에서:
"배포하고, 에러가 있으면 수정하고, 
다시 배포해줘"
```

### 예시 3: 완전 자동화

```
Composer에서:
"이 코드를 배포하고, 
빌드 에러가 발생하면 자동으로 수정하고, 
성공할 때까지 반복해줘"
```

## 🔍 MCP 도구 활용 예시

Cursor에서 직접 MCP 도구를 사용할 수도 있습니다:

### 배포 목록 조회
```
"Vercel 프로젝트의 최근 배포 5개를 보여줘"
```

### 특정 배포 확인
```
"배포 dpl_abc123의 상태와 빌드 로그를 확인해줘"
```

### 에러 로그 추출
```
"최근 실패한 배포의 빌드 로그를 가져와서 
에러 부분만 추출해줘"
```

## ⚙️ 고급 설정

### 환경별 배포

```
"Preview 환경에 배포하고, 
테스트 통과하면 Production에 배포해줘"
```

### 롤백 자동화

```
"최근 배포가 실패했으면 
이전 성공한 배포로 롤백해줘"
```

## 🚨 주의사항

1. **자동 커밋 주의**: 중요한 변경사항은 수동 검토
2. **토큰 보안**: Vercel 토큰은 안전하게 보관
3. **비용 관리**: 자동 재배포 시 API 호출 비용 주의
4. **에러 루프**: 무한 루프 방지를 위한 최대 재시도 설정

## 📚 참고 자료

- [Vercel MCP 문서](https://vercel.com/docs)
- [Cursor MCP 가이드](https://cursor.sh/docs)
- [자동 배포 가이드](./AUTO_DEPLOYMENT_GUIDE.md)

## 💡 팁

1. **에러 패턴 학습**: 자주 발생하는 에러는 자동 수정 가능
2. **단계별 배포**: Preview → Production 순서 권장
3. **로컬 테스트**: 배포 전 `npm run build`로 로컬 빌드 테스트

